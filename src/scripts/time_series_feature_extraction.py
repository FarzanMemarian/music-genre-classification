'''
create sql dataset from hdf5 files directly
   
@author - Ken Lee
 this is based on Andrew's id_title_artist.py and Alen's create_song_sql.py
'''

# in this cell, some of the features of MSD dataset are imported and stored in SQL table. 

#-------------------------
# Libs
#-------------------------

import os, sys
from tqdm import tqdm
import pymysql.cursors
import pandas as pd
import numpy as np
import glob
import csv
import json
from pprint import pprint
import unicodedata
import re
import string

from tsfresh import extract_features, extract_relevant_features, select_features
from tsfresh.utilities.dataframe_functions import impute
from tsfresh.feature_extraction import FeatureExtractionSettings

sys.path.append( os.path.realpath("%s/.."%os.path.dirname(__file__)) )
from util import mysql_util, hdf5_getters, settings

#-------------------------
# Globals
#-------------------------
glob_path = settings.msds_path
filepaths = glob.glob(glob_path)
COLUMN_NAMES = ['loud0__approximate_entropy__m_2__r_07', 'loud0__approximate_entropy__m_2__r_05', 'loud0__approximate_entropy__m_2__r_03', 'loud0__approximate_entropy__m_2__r_01', 'loud0__approximate_entropy__m_2__r_09', 'loud0__autocorrelation__lag_1', 'loud0__autocorrelation__lag_3', 'loud0__autocorrelation__lag_5', 'loud0__autocorrelation__lag_9', 'loud0__abs_energy', 'loud0__autocorrelation__lag_7', 'loud0__kurtosis', 'loud0__mean_autocorrelation', 'loud0__autocorrelation__lag_0', 'loud0__autocorrelation__lag_2', 'loud0__autocorrelation__lag_4', 'loud0__autocorrelation__lag_6', 'loud0__autocorrelation__lag_8', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_20', 'pitch0__approximate_entropy__m_2__r_07', 'pitch0__approximate_entropy__m_2__r_05', 'pitch0__approximate_entropy__m_2__r_03', 'pitch0__approximate_entropy__m_2__r_01', 'pitch0__approximate_entropy__m_2__r_09', 'pitch0__autocorrelation__lag_1', 'pitch0__autocorrelation__lag_3', 'pitch0__autocorrelation__lag_5', 'pitch0__autocorrelation__lag_9', 'pitch0__abs_energy', 'pitch0__autocorrelation__lag_7', 'pitch0__kurtosis', 'pitch0__mean_autocorrelation', 'pitch0__autocorrelation__lag_0', 'pitch0__autocorrelation__lag_2', 'pitch0__autocorrelation__lag_4', 'pitch0__autocorrelation__lag_6', 'pitch0__autocorrelation__lag_8', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_20', 'timbre0__approximate_entropy__m_2__r_07', 'timbre0__approximate_entropy__m_2__r_05', 'timbre0__approximate_entropy__m_2__r_03', 'timbre0__approximate_entropy__m_2__r_01', 'timbre0__approximate_entropy__m_2__r_09', 'timbre0__autocorrelation__lag_1', 'timbre0__autocorrelation__lag_3', 'timbre0__autocorrelation__lag_5', 'timbre0__autocorrelation__lag_9', 'timbre0__abs_energy', 'timbre0__autocorrelation__lag_7', 'timbre0__kurtosis', 'timbre0__mean_autocorrelation', 'timbre0__autocorrelation__lag_0', 'timbre0__autocorrelation__lag_2', 'timbre0__autocorrelation__lag_4', 'timbre0__autocorrelation__lag_6', 'timbre0__autocorrelation__lag_8', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_20']
# FEATURE_LIST = ['0__approximate_entropy__m_2__r_0.7', '0__approximate_entropy__m_2__r_0.5', '0__approximate_entropy__m_2__r_0.3', '0__approximate_entropy__m_2__r_0.1', '0__approximate_entropy__m_2__r_0.9', '0__autocorrelation__lag_1', '0__autocorrelation__lag_3', '0__autocorrelation__lag_5', '0__autocorrelation__lag_9', '0__abs_energy', '0__autocorrelation__lag_7', '0__kurtosis', '0__mean_autocorrelation', '0__autocorrelation__lag_0', '0__autocorrelation__lag_2', '0__autocorrelation__lag_4', '0__autocorrelation__lag_6', '0__autocorrelation__lag_8', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_0__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_0__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_0__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_0__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_1__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_1__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_1__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_1__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_2__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_2__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_2__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_2__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_3__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_3__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_3__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_3__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_4__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_4__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_4__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_4__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_5__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_5__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_5__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_5__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_6__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_6__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_6__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_6__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_7__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_7__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_7__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_7__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_8__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_8__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_8__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_8__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_9__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_9__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_9__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_9__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_10__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_10__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_10__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_10__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_11__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_11__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_11__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_11__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_12__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_12__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_12__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_12__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_13__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_13__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_13__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_13__w_20', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_14__w_2', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_14__w_5', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_14__w_10', '0__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_14__w_20']
FEATURE_NAMES = ['track_id', 'segments_length'] + COLUMN_NAMES
FEATURE_LIST = ['1__approximate_entropy__m_2__r_0.7', '1__approximate_entropy__m_2__r_0.5', '1__approximate_entropy__m_2__r_0.3', '1__approximate_entropy__m_2__r_0.1', '1__approximate_entropy__m_2__r_0.9', '1__autocorrelation__lag_1', '1__autocorrelation__lag_3', '1__autocorrelation__lag_5', '1__autocorrelation__lag_9', '1__abs_energy', '1__autocorrelation__lag_7', '1__kurtosis', '1__mean_autocorrelation', '1__autocorrelation__lag_0', '1__autocorrelation__lag_2', '1__autocorrelation__lag_4', '1__autocorrelation__lag_6', '1__autocorrelation__lag_8', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_0__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_0__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_0__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_0__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_1__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_1__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_1__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_1__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_2__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_2__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_2__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_2__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_3__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_3__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_3__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_3__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_4__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_4__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_4__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_4__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_5__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_5__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_5__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_5__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_6__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_6__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_6__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_6__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_7__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_7__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_7__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_7__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_8__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_8__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_8__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_8__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_9__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_9__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_9__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_9__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_10__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_10__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_10__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_10__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_11__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_11__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_11__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_11__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_12__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_12__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_12__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_12__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_13__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_13__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_13__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_13__w_20', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_14__w_2', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_14__w_5', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_14__w_10', '1__cwt_coefficients__widths_(2, 5, 10, 20)__coeff_14__w_20']


#-------------------------
# Functions
#-------------------------
def init_tables():
    print "Initializing tables"
    COLUMN_NAMES = ['loud0__approximate_entropy__m_2__r_07', 'loud0__approximate_entropy__m_2__r_05', 'loud0__approximate_entropy__m_2__r_03', 'loud0__approximate_entropy__m_2__r_01', 'loud0__approximate_entropy__m_2__r_09', 'loud0__autocorrelation__lag_1', 'loud0__autocorrelation__lag_3', 'loud0__autocorrelation__lag_5', 'loud0__autocorrelation__lag_9', 'loud0__abs_energy', 'loud0__autocorrelation__lag_7', 'loud0__kurtosis', 'loud0__mean_autocorrelation', 'loud0__autocorrelation__lag_0', 'loud0__autocorrelation__lag_2', 'loud0__autocorrelation__lag_4', 'loud0__autocorrelation__lag_6', 'loud0__autocorrelation__lag_8', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_20', 'pitch0__approximate_entropy__m_2__r_07', 'pitch0__approximate_entropy__m_2__r_05', 'pitch0__approximate_entropy__m_2__r_03', 'pitch0__approximate_entropy__m_2__r_01', 'pitch0__approximate_entropy__m_2__r_09', 'pitch0__autocorrelation__lag_1', 'pitch0__autocorrelation__lag_3', 'pitch0__autocorrelation__lag_5', 'pitch0__autocorrelation__lag_9', 'pitch0__abs_energy', 'pitch0__autocorrelation__lag_7', 'pitch0__kurtosis', 'pitch0__mean_autocorrelation', 'pitch0__autocorrelation__lag_0', 'pitch0__autocorrelation__lag_2', 'pitch0__autocorrelation__lag_4', 'pitch0__autocorrelation__lag_6', 'pitch0__autocorrelation__lag_8', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_20', 'timbre0__approximate_entropy__m_2__r_07', 'timbre0__approximate_entropy__m_2__r_05', 'timbre0__approximate_entropy__m_2__r_03', 'timbre0__approximate_entropy__m_2__r_01', 'timbre0__approximate_entropy__m_2__r_09', 'timbre0__autocorrelation__lag_1', 'timbre0__autocorrelation__lag_3', 'timbre0__autocorrelation__lag_5', 'timbre0__autocorrelation__lag_9', 'timbre0__abs_energy', 'timbre0__autocorrelation__lag_7', 'timbre0__kurtosis', 'timbre0__mean_autocorrelation', 'timbre0__autocorrelation__lag_0', 'timbre0__autocorrelation__lag_2', 'timbre0__autocorrelation__lag_4', 'timbre0__autocorrelation__lag_6', 'timbre0__autocorrelation__lag_8', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_20']
    COLUMN_NAMES = COLUMN_NAMES[78:]
    FEATURE_NAMES = ['track_id', 'segments_length'] + COLUMN_NAMES
    # Drop database
    q = """DROP TABLE IF EXISTS time_series_features;"""
    mysql_util.execute_query(q)

    # Create table schema
    sql = """CREATE TABLE IF NOT EXISTS time_series_features (

        track_id VARCHAR(64),
        segments_length INT,
        deleted tinyint(1) DEFAULT 0,
        has_lyrics tinyint(1) DEFAULT 0,
        PRIMARY KEY (track_id)
    );"""
    print sql
    mysql_util.execute_query(sql)
    for c in COLUMN_NAMES:
        sql = """ALTER TABLE time_series_features ADD COLUMN %s REAL;""" % c
        mysql_util.execute_query(sql)

# Importing the data to sql
def import_data_to_sql():
    # Check to make sure valid inputs
    COLUMN_NAMES = ['loud0__approximate_entropy__m_2__r_07', 'loud0__approximate_entropy__m_2__r_05', 'loud0__approximate_entropy__m_2__r_03', 'loud0__approximate_entropy__m_2__r_01', 'loud0__approximate_entropy__m_2__r_09', 'loud0__autocorrelation__lag_1', 'loud0__autocorrelation__lag_3', 'loud0__autocorrelation__lag_5', 'loud0__autocorrelation__lag_9', 'loud0__abs_energy', 'loud0__autocorrelation__lag_7', 'loud0__kurtosis', 'loud0__mean_autocorrelation', 'loud0__autocorrelation__lag_0', 'loud0__autocorrelation__lag_2', 'loud0__autocorrelation__lag_4', 'loud0__autocorrelation__lag_6', 'loud0__autocorrelation__lag_8', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_0__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_1__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_2__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_3__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_4__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_5__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_6__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_7__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_8__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_9__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_10__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_11__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_12__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_13__w_20', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_2', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_5', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_10', 'loud0__cwt_coefficients__widths_251020__coeff_14__w_20', 'pitch0__approximate_entropy__m_2__r_07', 'pitch0__approximate_entropy__m_2__r_05', 'pitch0__approximate_entropy__m_2__r_03', 'pitch0__approximate_entropy__m_2__r_01', 'pitch0__approximate_entropy__m_2__r_09', 'pitch0__autocorrelation__lag_1', 'pitch0__autocorrelation__lag_3', 'pitch0__autocorrelation__lag_5', 'pitch0__autocorrelation__lag_9', 'pitch0__abs_energy', 'pitch0__autocorrelation__lag_7', 'pitch0__kurtosis', 'pitch0__mean_autocorrelation', 'pitch0__autocorrelation__lag_0', 'pitch0__autocorrelation__lag_2', 'pitch0__autocorrelation__lag_4', 'pitch0__autocorrelation__lag_6', 'pitch0__autocorrelation__lag_8', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_0__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_1__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_2__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_3__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_4__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_5__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_6__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_7__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_8__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_9__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_10__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_11__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_12__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_13__w_20', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_2', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_5', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_10', 'pitch0__cwt_coefficients__widths_251020__coeff_14__w_20', 'timbre0__approximate_entropy__m_2__r_07', 'timbre0__approximate_entropy__m_2__r_05', 'timbre0__approximate_entropy__m_2__r_03', 'timbre0__approximate_entropy__m_2__r_01', 'timbre0__approximate_entropy__m_2__r_09', 'timbre0__autocorrelation__lag_1', 'timbre0__autocorrelation__lag_3', 'timbre0__autocorrelation__lag_5', 'timbre0__autocorrelation__lag_9', 'timbre0__abs_energy', 'timbre0__autocorrelation__lag_7', 'timbre0__kurtosis', 'timbre0__mean_autocorrelation', 'timbre0__autocorrelation__lag_0', 'timbre0__autocorrelation__lag_2', 'timbre0__autocorrelation__lag_4', 'timbre0__autocorrelation__lag_6', 'timbre0__autocorrelation__lag_8', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_0__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_1__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_2__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_3__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_4__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_5__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_6__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_7__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_8__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_9__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_10__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_11__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_12__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_13__w_20', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_2', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_5', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_10', 'timbre0__cwt_coefficients__widths_251020__coeff_14__w_20']
    COLUMN_NAMES = COLUMN_NAMES[78:]
    FEATURE_NAMES = ['track_id', 'segments_length'] + COLUMN_NAMES
    start_query = 'INSERT IGNORE INTO time_series_features %s VALUES' % str(tuple(FEATURE_NAMES)).replace("'","")
    feature_key_words = ['cwt_coefficients','percentage_of_reoccuring_values_to_all_values',\
    'autocorrelation','kurtosis','abs_energy','approximate_entropy']
    extraction_settings = FeatureExtractionSettings()
    extraction_settings.set_default_parameters('0')
    extraction_settings.set_default_parameters('1')
    extraction_settings.set_default_parameters('2')
    extraction_settings.do_not_calculate('0','time_reversal_asymmetry_statistic')
    extraction_settings.do_not_calculate('1','time_reversal_asymmetry_statistic')
    extraction_settings.do_not_calculate('2','time_reversal_asymmetry_statistic')
    extraction_settings.do_not_calculate('0','symmetry_looking')
    extraction_settings.do_not_calculate('1','symmetry_looking')
    extraction_settings.do_not_calculate('2','symmetry_looking')
    extraction_settings.do_not_calculate('0','large_standard_deviation')
    extraction_settings.do_not_calculate('1','large_standard_deviation')
    extraction_settings.do_not_calculate('2','large_standard_deviation')
    extraction_settings.do_not_calculate('0','quantile')
    extraction_settings.do_not_calculate('1','quantile')
    extraction_settings.do_not_calculate('2','quantile')
    extraction_settings.do_not_calculate('0','number_cwt_peaks')
    extraction_settings.do_not_calculate('1','number_cwt_peaks')
    extraction_settings.do_not_calculate('2','number_cwt_peaks')
    extraction_settings.do_not_calculate('0','number_peaks')
    extraction_settings.do_not_calculate('1','number_peaks')
    extraction_settings.do_not_calculate('2','number_peaks')
    extraction_settings.do_not_calculate('0','large_number_of_peaks')
    extraction_settings.do_not_calculate('1','large_number_of_peaks')
    extraction_settings.do_not_calculate('2','large_number_of_peaks')


    extraction_settings.do_not_calculate('0','binned_entropy')
    extraction_settings.do_not_calculate('1','binned_entropy')
    extraction_settings.do_not_calculate('2','binned_entropy')


    extraction_settings.do_not_calculate('0','index_mass_quantile')
    extraction_settings.do_not_calculate('1','index_mass_quantile')
    extraction_settings.do_not_calculate('2','index_mass_quantile')


    extraction_settings.do_not_calculate('0','spkt_welch_density')
    extraction_settings.do_not_calculate('1','spkt_welch_density')
    extraction_settings.do_not_calculate('2','spkt_welch_density')


    extraction_settings.do_not_calculate('0','ar_coefficient')
    extraction_settings.do_not_calculate('1','ar_coefficient')
    extraction_settings.do_not_calculate('2','ar_coefficient')

    extraction_settings.do_not_calculate('0','mean_abs_change_quantiles')
    extraction_settings.do_not_calculate('1','mean_abs_change_quantiles')
    extraction_settings.do_not_calculate('2','mean_abs_change_quantiles')

    extraction_settings.do_not_calculate('0','fft_coefficient')
    extraction_settings.do_not_calculate('1','fft_coefficient')
    extraction_settings.do_not_calculate('2','fft_coefficient')

    extraction_settings.do_not_calculate('0','value_count')
    extraction_settings.do_not_calculate('1','value_count')
    extraction_settings.do_not_calculate('2','value_count')

    extraction_settings.do_not_calculate('0','range_count')
    extraction_settings.do_not_calculate('1','range_count')
    extraction_settings.do_not_calculate('2','range_count')

    extraction_settings.do_not_calculate('0','friedrich_coefficients')
    extraction_settings.do_not_calculate('1','friedrich_coefficients')
    extraction_settings.do_not_calculate('2','friedrich_coefficients')

    extraction_settings.do_not_calculate('0','max_langevin_fixed_point')
    extraction_settings.do_not_calculate('1','max_langevin_fixed_point')
    extraction_settings.do_not_calculate('2','max_langevin_fixed_point')
    
    # extraction_settings.n_processes = 10
    if len(sys.argv) < 2:
        print "Must array of alphabaet characters"
        return

    input_letters = sys.argv[1:]

    alphas = list(string.ascii_uppercase)
    




    # print input_letters

    # Loop only though alphabet
    for letter in alphas:
        # If letter in input, then loop through
        if letter in input_letters:
                path = settings.base_msds_path.replace("$VAL", letter)
                print path
                filepaths = glob.glob(path)

                # Filepath for only letter named songs
                for filepath in tqdm(filepaths):
                    h5 = hdf5_getters.open_h5_file_read(filepath)
                    n = hdf5_getters.get_num_songs(h5)
                    for row in range(n):
                        feature_list = []
                        feature_vector = []
                        track_id = hdf5_getters.get_track_id(h5, songidx=row)
                        query = """SELECT is_train_test from songs where track_id = '%s';""" % track_id
                        is_train_test = mysql_util.execute_query(query)
                        if list(list(is_train_test))[0][0] != 1:
                            continue

                        #time series features
                        #perfom feature extraction
                        segments_pitches = hdf5_getters.get_segments_pitches(h5,songidx=row)
                        segments_timbre = hdf5_getters.get_segments_timbre(h5,songidx=row)
                        # max_loudness = hdf5_getters.get_segments_loudness_max(h5,songidx=row)
                        segments_length = segments_pitches.shape[0]
                        length = np.copy(segments_length)
                        if np.isnan(length): length = 0
                        if segments_length > 500:
                            segments_length = 500
                        # max_loudness = max_loudness[0:500]
                        segments_pitches= segments_pitches[0:500]
                        segments_timbre = segments_timbre[0:500]
                        segments_pitches = np.mean(segments_pitches,axis=1).reshape(segments_length,1)
                        segments_timbre = np.mean(segments_timbre,axis=1).reshape(segments_length,1)
                        # max_loudness = max_loudness.reshape(segments_length,1)
                        # zeros = np.zeros((segments_length,1))
                        ones = np.ones((segments_length,1))
                        twos = np.ones((segments_length,1))*2

                        # max_loudness = np.hstack((zeros,max_loudness))
                        segments_pitches = np.hstack((ones,segments_pitches))
                        segments_timbre = np.hstack((twos,segments_timbre))
                        ts = np.concatenate((segments_pitches,segments_timbre))
                        time_series = pd.DataFrame(ts)
                        ts_features = extract_features(time_series,column_id=0,feature_extraction_settings=extraction_settings, parallelization='per_kind')
                        feature_vector = ts_features[FEATURE_LIST].as_matrix()
                        feature_vector = feature_vector.reshape(feature_vector.shape[0]*feature_vector.shape[1],)
                        feature_vector = np.nan_to_num(feature_vector)
                        meta_features = ['%s' % str(track_id), str(length).replace("'","")]
                        features = meta_features + feature_vector.tolist()
                        insert_query = start_query + '%s' % str(tuple(features))
                        insert_query = """%s""" % insert_query
                        mysql_util.execute_query(insert_query)

                        

                    h5.close()

# Main Script
def main():
    # 1.) Init tables
    #init_tables()

    # 2.) Import data from songs hdf5 files to sql
    import_data_to_sql()





if __name__=="__main__":
    main()
